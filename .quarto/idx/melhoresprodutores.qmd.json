{"title":"AN√ÅLISE ESTAT√çSTICA PARA AS ATIVIDADES ENZIM√ÅTICAS","markdown":{"yaml":{"title":"","format":"html","editor":"visual"},"headingText":"AN√ÅLISE ESTAT√çSTICA PARA AS ATIVIDADES ENZIM√ÅTICAS","containsRefs":false,"markdown":"\n\n\n## Delineamento Experimental e Conjunto de dados:\n\nNossos dados comportam a atividade enzim√°tica da cole√ß√£o f√∫ngica CMPC coletados no Sul do Brasil.\n\n-   A planilha excel cont√©m dados de 53 isolados induzidos em 3 diferentes substratos, dos quais vamos quantificar a express√£o de 7 enzimas.\n-   2 r√©plicas por isolado, cada uma com 3 erlenmeyers.\n\n# üìä Metodologia estat√≠stica aplicada:\n\n## Sele√ß√£o dos melhores produtores utilizando apenas m√©dia simples\n\nEssa sele√ß√£o foi feita utilizando apenas as maiores atividades m√©dias por enzima desconsiderando o fator biomassa:\n\nEsse c√≥digo exporta a tabela de maiores m√©dias demonstrando (enzima + isolado + m√©dia de atividade+ biomassa) + gr√°fico de barras empilhadas por enzima analisada.\n\n```{r}\n# Carregar pacotes necess√°rios\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(openxlsx)\n\n# Ler os dados\ndados <- read_excel(\"at_enz.xlsx\")\n\n# Calcular m√©dia de atividade por Enzima, Isolado e Biomassa\nmedia_atividade_com_biomassa <- dados %>%\n  group_by(Enzima, Isolado, Biomassa) %>%\n  summarise(Media_Atividade = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n\n# Calcular a m√©dia geral por Enzima e Isolado (sem considerar biomassa)\nmedia_atividade <- media_atividade_com_biomassa %>%\n  group_by(Enzima, Isolado) %>%\n  summarise(Media_Atividade = mean(Media_Atividade), .groups = \"drop\")\n\n# Selecionar top 3 isolados por enzima\ntop_isolados <- media_atividade %>%\n  group_by(Enzima) %>%\n  slice_max(order_by = Media_Atividade, n = 3) %>%\n  arrange(Enzima, desc(Media_Atividade)) %>%\n  ungroup()\n\n# Para cada top isolado, identificar qual biomassa teve maior m√©dia\nbiomassa_destaque <- media_atividade_com_biomassa %>%\n  semi_join(top_isolados, by = c(\"Enzima\", \"Isolado\")) %>%\n  group_by(Enzima, Isolado) %>%\n  slice_max(order_by = Media_Atividade, n = 1) %>%\n  select(Enzima, Isolado, Biomassa)\n\n# Juntar com a tabela final\nresultado_final <- top_isolados %>%\n  left_join(biomassa_destaque, by = c(\"Enzima\", \"Isolado\"))\n\n# Exportar para Excel\nwrite.xlsx(resultado_final, \"top_isolados_com_biomassa_destaque.xlsx\")\n\n# Criar gr√°ficos para cada enzima\nenzimas <- unique(dados$Enzima)\n\ndir.create(\"graficos\", showWarnings = FALSE)  # Pasta para salvar os gr√°ficos\n\nfor (enz in enzimas) {\n  dados_grafico <- dados %>%\n    filter(Enzima == enz) %>%\n    group_by(Isolado, Biomassa) %>%\n    summarise(Media = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n  \n  p <- ggplot(dados_grafico, aes(x = factor(Isolado), y = Media, fill = Biomassa)) +\n    geom_bar(stat = \"identity\", position = \"stack\") +\n    labs(title = paste(\"Atividade m√©dia por biomassa -\", enz),\n         x = \"Isolado\",\n         y = \"Atividade M√©dia\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  \n  # Salvar gr√°fico\n  ggsave(filename = paste0(\"graficos/\", enz, \"_grafico.png\"),\n         plot = p, width = 8, height = 5)\n}\n\n```\n\n## Sele√ß√£o utilizando estat√≠stica robusta e compara√ß√£o de m√©dias\n\nEsse c√≥digo:\n\n-   Faz an√°lise para cada enzima.\n\n-   Detecta se ANOVA+Tukey ou Kruskal+Dunn √© adequado.\n\n-   Seleciona top 5 isolados (baseado na m√©dia da melhor biomassa).\n\n-   No gr√°fico, barras s√£o coloridas pela biomassa da melhor m√©dia.\n\n-   Asterisco vermelho indica isolados significativamente diferentes do melhor isolado.\n\n-   Exporta uma tabela com isolado, biomassa, m√©dia e asterisco.\n\n```{r}\n# Pacotes necess√°rios\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(rstatix)\nlibrary(ggplot2)\nlibrary(openxlsx)\nlibrary(patchwork)\n\n# Ler os dados\ndados <- read_excel(\"at_enz.xlsx\")\n\n# Converter vari√°veis para fator\ndados <- dados %>%\n  mutate(\n    Enzima = as.factor(Enzima),\n    Isolado = as.factor(Isolado),\n    Biomassa = as.factor(Biomassa),\n    Tubo = as.factor(Tubo),\n    Repeticao = as.factor(Repeticao)\n  )\n\n# Objeto para armazenar os melhores isolados por estat√≠stica e biomassa\ntabela_melhores <- data.frame()\n\n# Loop por enzima\nfor (enzima in unique(dados$Enzima)) {\n  cat(\"\\n\\n===== Enzima:\", enzima, \"=====\\n\")\n  \n  subdados <- dados %>% filter(Enzima == enzima)\n  \n  # Calcular m√©dia da atividade por Isolado e Biomassa\n  medias <- subdados %>%\n    group_by(Isolado, Biomassa) %>%\n    summarise(Media_Atividade = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n  \n  # Para cada isolado, escolher a biomassa com maior m√©dia\n  melhores <- medias %>%\n    group_by(Isolado) %>%\n    slice_max(order_by = Media_Atividade, n = 1) %>%\n    ungroup()\n  \n  # Ordenar pelo topo 5 isolados\n  melhores <- melhores %>%\n    arrange(desc(Media_Atividade)) %>%\n    slice_head(n = 5)\n  \n  # Teste de normalidade\n  shapiro_p <- tryCatch({\n    shapiro_test(subdados, Atividade)$p\n  }, error = function(e) {\n    NA\n  })\n  \n  # Teste de homogeneidade de vari√¢ncias (Levene)\n  levene_p <- tryCatch({\n    levene_test(subdados, Atividade ~ Isolado)$p\n  }, error = function(e) {\n    NA\n  })\n  \n  cat(\"Shapiro-Wilk p-valor:\", shapiro_p, \"\\n\")\n  cat(\"Levene p-valor:\", levene_p, \"\\n\")\n  \n  if (!is.na(shapiro_p) && !is.na(levene_p) && shapiro_p > 0.05 && levene_p > 0.05) {\n    cat(\"‚Üí Dados normais e homog√™neos: ANOVA + Tukey\\n\")\n    \n    anova <- aov(Atividade ~ Isolado, data = subdados)\n    tukey <- TukeyHSD(anova)\n    \n    tukey_df <- as.data.frame(tukey$Isolado)\n    tukey_df$Comparacao <- rownames(tukey_df)\n    \n    melhor_isolado <- melhores$Isolado[1]\n    \n    # Isolados que diferem significativamente do melhor isolado\n    comparacoes_relevantes <- tukey_df %>%\n      filter(grepl(melhor_isolado, Comparacao)) %>%\n      mutate(\n        outro_isolado = ifelse(grepl(melhor_isolado, Comparacao),\n                              sub(\".*-\", \"\", Comparacao),\n                              sub(\"-.*\", \"\", Comparacao)),\n        signif = `p.adj` < 0.05\n      )\n    \n    isolados_significativos <- comparacoes_relevantes %>%\n      filter(signif == TRUE) %>%\n      pull(outro_isolado) %>%\n      unique()\n    \n    melhores <- melhores %>%\n      mutate(asterisco = ifelse(Isolado %in% isolados_significativos, \"*\", \"\"))\n    \n  } else {\n    cat(\"‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\\n\")\n    \n    kruskal <- kruskal_test(subdados, Atividade ~ Isolado)\n    print(kruskal)\n    \n    dunn <- dunn_test(subdados, Atividade ~ Isolado, p.adjust.method = \"bonferroni\")\n    \n    melhor_isolado <- melhores$Isolado[1]\n    \n    # Isolados que diferem significativamente do melhor isolado (p.adj < 0.05)\n    isolados_significativos <- dunn %>%\n      filter((group1 == melhor_isolado | group2 == melhor_isolado) & p.adj < 0.05) %>%\n      mutate(outro_isolado = ifelse(group1 == melhor_isolado, group2, group1)) %>%\n      pull(outro_isolado) %>%\n      unique()\n    \n    melhores <- melhores %>%\n      mutate(asterisco = ifelse(Isolado %in% isolados_significativos, \"*\", \"\"))\n  }\n  \n  # Gr√°fico\n  p <- ggplot(melhores, aes(x = reorder(Isolado, -Media_Atividade), y = Media_Atividade, fill = Biomassa)) +\n    geom_col() +\n    geom_text(aes(label = asterisco), vjust = -0.5, size = 8, color = \"red\") +\n    labs(title = paste(\"Top 5 Isolados -\", enzima),\n         x = \"Isolado\", y = \"M√©dia de Atividade\", fill = \"Biomassa\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  \n  print(p)\n  \n  # Adicionar coluna de enzima para exporta√ß√£o\n  melhores$Enzima <- enzima\n  \n  # Juntar na tabela final\n  tabela_melhores <- bind_rows(tabela_melhores, melhores)\n}\n\n# Exportar tabela final com melhores isolados, biomassa e indica√ß√£o de signific√¢ncia\nwrite.xlsx(tabela_melhores, \"melhores_isolados_por_estatistica.xlsx\", rownames = FALSE)\n\n\n```\n\n## Visualiza√ß√£o dos melhores isolados\n\nEsse c√≥digo cria um gr√°fico facetado com as m√©dias dos melhores isolados por enzima.\n\n```{r}\n\n# Gr√°fico facetado com todos os melhores isolados\nlibrary(readxl)\nlibrary(ggplot2)\n\n# Ler arquivo Excel - substitua \"dados.xlsx\" pelo nome do seu arquivo\ndf <- read_excel(\"melhores_isolados_por_estatistica.xlsx\")\n\n# Mostrar as primeiras linhas para conferir os dados\nhead(df)\n\n# Criar gr√°fico de barras facetado com eixos independentes\nnomes_enzyme <- c(\n  \"xil\" = \"Xilanase\",\n  \"endog\" = \"Endoglucanase\",\n  \"fpa\" = \"FPase\",\n  \"lac\" = \"Lacase\",\n  \"bgli\" = \"Œ≤ glicosidase\",\n  \"bxil\" = \"Œ≤ xilosidase\",\n  \"mangper\" = \"Mangan√™s peroxidase\"\n)\n\nggplot(df, aes(x = Isolado, y = Media_Atividade, fill = Biomassa)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.8)) +\n  facet_wrap(~ Enzima, scales = \"free\", labeller = labeller(Enzima = nomes_enzyme)) +\n  labs(\n    title = \"M√©dias agrupadas por Biomassa\",\n    fill = \"Biomassa\",\n    caption = \"Fonte: Elaborado pela autora, 2025.\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n\n```\n\n## Visualiza√ß√£o da identifica√ß√£o a nivel de g√™nero\n\nQuanto a identifica√ß√£o a nivel de g√™nero:\n\n```{r}\n# Instalar pacotes, se ainda n√£o tiver\nif (!require(readxl)) install.packages(\"readxl\")\nif (!require(ggplot2)) install.packages(\"ggplot2\")\n\nlibrary(readxl)\nlibrary(ggplot2)\n\n# 1. Carregar o arquivo Excel\n# Substitua \"arquivo.xlsx\" pelo nome real do seu arquivo\ndados_tax <- read_excel(\"cap1.xlsx\", sheet = 2)\n\n# 2. Verificar as colunas (opcional)\nhead(dados_tax)\ncolnames(dados_tax)\n\n# 3. Calcular a frequ√™ncia dos filos\nfreq_ordem <- as.data.frame(table(dados_tax$ordem))\ncolnames(freq_ordem) <- c(\"ordem\", \"frequencia\")\n\n# 4. Calcular a porcentagem\nfreq_ordem$porcentagem <- round(100 * freq_ordem$frequencia / sum(freq_ordem$frequencia), 1)\n\n# 5. Criar r√≥tulo para a legenda\nfreq_ordem$label <- paste0(freq_ordem$ordem, \" (\", freq_ordem$porcentagem, \"%)\")\n\n# 6. Gerar o gr√°fico de pizza\nggplot(freq_ordem, aes(x = \"\", y = frequencia, fill = label)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(\"y\", start = 0) +\n  labs(caption = \"Fonte: Betim, 2025.\") +\n  theme_void() +\n  theme(legend.position = \"right\") +\n  guides(fill = guide_legend(title = \"Ordem\"))\n\n\n```\n\n# ANALISE ESTAT√çSTICA PARA A BIODEGRADA√á√ÉO ACELERADA\n\n## Delineamento Experimental e Conjunto de Dados\n\nNossos dados comportam dados das propriedades fisicas da madeira degradada com isolados selecionados na cole√ß√£o f√∫ngica CMPC coletados no Sul do Brasil.\n\n-   A planilha excel cont√©m dados de 23 isolados induzidos em 3 diferentes substratos, dos quais vamos quantificar a perda de massa, a perda de dureza em rela√ß√£o ao controle negativo e a perda de densidade aparente;\n-   3 r√©plicas por isolado, cada uma com 3 cavacos.\n\n### üìå‚úÖ **O que esse script faz?**\n\n1.  **Carregamento de pacotes** apropriados para an√°lise estat√≠stica e visualiza√ß√£o.\n\n2.  **Importa√ß√£o de dados** do Excel.\n\n3.  **Fun√ß√£o gen√©rica** que: executa ANOVA, realiza o teste de Tukey, se todas as premissas forem atendidas, e no caso de violadas executa teste n√£o param√©trico, extrai letras de signific√¢ncia com `multcompLetters4`, gera gr√°fico de barras com m√©dias e letras.\n\n4.  **Execu√ß√£o da fun√ß√£o** para m√∫ltiplas vari√°veis com diferentes r√≥tulos de eixo Y.\n\n```{# === 0. Carregar pacotes ===}\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(multcompView)\nlibrary(agricolae)\nlibrary(FSA)\nlibrary(car)\nlibrary(Polychrome)\n\n# === 1. Carregar os dados ===\ndados <- read_excel(\"teste_deg.xlsx\")\ndados$tratamento <- as.factor(dados$tratamento)\n\n# === 2. Fun√ß√£o de an√°lise completa ===\nanalise_variavel <- function(dados, variavel, y_label) {\n  dados_var <- dados %>% filter(!is.na(.data[[variavel]]))\n  formula <- as.formula(paste(variavel, \"~ tratamento\"))\n  \n  modelo <- aov(formula, data = dados_var)\n  residuos <- residuals(modelo)\n  \n  # === Testes de premissas ===\n  shapiro_result <- shapiro.test(residuos)\n  levene_result <- leveneTest(formula, data = dados_var)\n  \n  shapiro_p <- shapiro_result$p.value\n  levene_p <- levene_result$`Pr(>F)`[1]\n\n  cat(\"\\n=== An√°lise para\", variavel, \"===\\n\")\n  cat(\"‚Üí Teste de Normalidade (Shapiro-Wilk):\\n\")\n  print(shapiro_result)\n\n  cat(\"\\n‚Üí Teste de Homocedasticidade (Levene):\\n\")\n  print(levene_result)\n\n  # === Diagn√≥stico visual dos res√≠duos ===\n  cat(\"\\n‚Üí Gr√°ficos de diagn√≥stico dos res√≠duos\\n\")\n  par(mfrow = c(1, 2))\n  plot(residuos, main = paste(\"Res√≠duos -\", variavel), ylab = \"Res√≠duos\")\n  abline(h = 0, col = \"red\", lty = 2)\n  qqnorm(residuos, main = paste(\"QQ-Plot -\", variavel))\n  qqline(residuos, col = \"red\")\n  par(mfrow = c(1, 1))\n\n  # Caminho 1: Premissas atendidas ‚Üí Scott-Knott\n  if (shapiro_p > 0.05 & levene_p > 0.05) {\n    cat(\"\\n‚Üí Premissas atendidas: usando ANOVA + Scott-Knott\\n\")\n    print(summary(modelo))\n    \n    scott <- agricolae::scott.test(modelo, \"tratamento\", group = TRUE, console = TRUE)\n    \n    letras_df <- scott$groups %>%\n      mutate(tratamento = rownames(.)) %>%\n      select(tratamento, grupo = groups)\n  \n  # Caminho 2: Premissas violadas ‚Üí Kruskal + Dunn\n  } else {\n    cat(\"\\n‚Üí Premissas violadas: usando Kruskal-Wallis + Dunn\\n\")\n    kruskal_res <- kruskal.test(formula, data = dados_var)\n    print(kruskal_res)\n    \n    dunn <- dunnTest(formula, data = dados_var, method = \"bonferroni\")\n    comp <- dunn$res\n    \n    tratamentos <- levels(dados_var$tratamento)\n    p_mat <- matrix(NA, nrow=length(tratamentos), ncol=length(tratamentos),\n                    dimnames = list(tratamentos, tratamentos))\n    \n    for (i in 1:nrow(comp)) {\n      pares <- strsplit(as.character(comp$Comparison[i]), \" - \")[[1]]\n      p_valor <- comp$P.adj[i]\n      p_mat[pares[1], pares[2]] <- p_valor\n      p_mat[pares[2], pares[1]] <- p_valor\n    }\n    \n    letras <- multcompLetters(p_mat, threshold = 0.05)\n    letras_df <- data.frame(tratamento = names(letras$Letters),\n                            grupo = letras$Letters)\n  }\n\n  # === Calcular m√©dias e unir com grupos ===\n  medias <- dados_var %>%\n    group_by(tratamento) %>%\n    summarise(media = mean(.data[[variavel]], na.rm = TRUE)) %>%\n    left_join(letras_df, by = \"tratamento\")\n\n  # === Identificar grupos √∫nicos e marcar com asterisco ===\n  grupo_freq <- table(medias$grupo)\n  medias <- medias %>%\n    mutate(asterisco = ifelse(grupo_freq[grupo] == 1, \"*\", \"\"))\n\n  # === Ordenar tratamentos por m√©dia decrescente ===\n  medias <- medias %>%\n    arrange(desc(media)) %>%\n    mutate(tratamento = factor(tratamento, levels = tratamento))\n\n  # === Cores com Polychrome (36 cores com alto contraste) ===\n  grupos_unicos <- sort(unique(medias$grupo))\n  paleta <- palette36.colors(length(grupos_unicos))\n  cores <- setNames(paleta, grupos_unicos)\n\n  # === Gr√°fico ===\n  grafico <- ggplot(medias, aes(x = tratamento, y = media, fill = grupo)) +\n    geom_col(width = 0.7) +\n    geom_text(aes(label = asterisco), vjust = -0.8, size = 6, color = \"black\") +\n    scale_fill_manual(values = cores) +\n    labs(\n      title = paste(\"M√©dia de\", y_label, \"por Tratamento\"),\n      x = \"Tratamento\",\n      y = y_label,\n      fill = \"Grupo\"\n    ) +\n    coord_flip() +\n    theme_minimal() +\n    theme(\n      text = element_text(size = 12),\n      plot.title = element_text(hjust = 0.5, face = \"bold\")\n    )\n  \n  print(grafico)\n}\n\n# === 3. Rodar an√°lises ===\nanalise_variavel(dados, \"pm\",  \"Perda de Massa (PM)\")\nanalise_variavel(dados, \"pdr\", \"Perda de Dureza Relativa (PDR)\")\nanalise_variavel(dados, \"pds\", \"Perda de Densidade Aparente (PDS)\")\n\n\n```\n\n### üìå **1. Vari√°vel: `pm` ‚Äì Perda de Massa**\n\n-   **Shapiro-Wilk**:\n\n```         \n-    W = 0.94606  -    p = **3.228e-08** ‚Üí ‚ùå Viola√ß√£o da normalidade\n```\n\n-   **Levene (homocedasticidade)**:\n\n```         \n-    F = 4.3557  -    p = **2.154e-09** ‚Üí ‚ùå Viola√ß√£o da homogeneidade de vari√¢ncias\n```\n\n-   **Decis√£o**: Premissas violadas ‚Üí Kruskal-Wallis + Dunn\n\n-   **Kruskal-Wallis**:\n\n```         \n-    œá¬≤ = 109.39, gl = 23  -    p = **3.229e-13** ‚Üí ‚úÖ Diferen√ßa significativa entre tratamentos\n```\n\n### üìå **2. Vari√°vel: `pdr` ‚Äì Perda de Dureza Relativa**\n\n-   **Shapiro-Wilk**:\n\n```         \n-    W = 0.93213  -   p = **1.413e-09** ‚Üí ‚ùå Viola√ß√£o da normalidade\n```\n\n-   **Levene**:\n\n```         \n-    F = 0.8714  -    p = **0.6371** ‚Üí ‚úÖ Homocedasticidade aceita\n```\n\n-   **Decis√£o**: Mesmo com vari√¢ncias homog√™neas, a normalidade foi violada ‚Üí Kruskal-Wallis + Dunn\n\n-   **Kruskal-Wallis**:\n\n```         \n-    œá¬≤ = 36.85, gl = 23  -    p = **0.0337** ‚Üí ‚úÖ Diferen√ßa significativa (moderada)\n```\n\n### üìå **3. Vari√°vel: `pds` ‚Äì Perda de Densidade Aparente**\n\n-   **Shapiro-Wilk**:\n\n```         \n-    W = 0.94844  -    p = **6.066e-08** ‚Üí ‚ùå Viola√ß√£o da normalidade\n```\n\n-   **Levene**:\n\n```         \n-    F = 5.0554  -    p = **2.486e-11** ‚Üí ‚ùå Viola√ß√£o da homocedasticidade\n```\n\n-   **Decis√£o**: Premissas violadas ‚Üí Kruskal-Wallis + Dunn\n\n-   **Kruskal-Wallis**:\n\n```         \n-    œá¬≤ = 108.57, gl = 23  -    p = **4.509e-13** ‚Üí ‚úÖ Diferen√ßa altamente significativa\n```\n\n## üß™ **Conclus√£o T√©cnica**\n\n| Vari√°vel | Normalidade | Homocedasticidade | Teste Utilizado | Resultado |\n|---------------|---------------|---------------|---------------|---------------|\n| `pm` | ‚ùå | ‚ùå | Kruskal-Wallis + Dunn | **Significativo** |\n| `pdr` | ‚ùå | ‚úÖ | Kruskal-Wallis + Dunn | **Significativo** |\n| `pds` | ‚ùå | ‚ùå | Kruskal-Wallis + Dunn | **Significativo** |\n\n## üìå Observa√ß√£o\n\n-   **Premissas violadas** ‚Üí teste **n√£o param√©trico**.\n\n-   O script est√° **automatizado, robusto e confi√°vel**.\n\n-   Os resultados indicam que **os tratamentos influenciam significativamente** nas tr√™s vari√°veis avaliadas.\n\n```{r}\n# === 0. Carregar pacotes ===\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(multcompView)\nlibrary(agricolae)\nlibrary(FSA)\nlibrary(car)\nlibrary(Polychrome)\n\n# === 1. Carregar os dados ===\ndados <- read_excel(\"teste_deg.xlsx\")\ndados$tratamento <- as.factor(dados$tratamento)\n\n# === 2. Fun√ß√£o de an√°lise completa ===\nanalise_variavel <- function(dados, variavel, y_label) {\n  dados_var <- dados %>% filter(!is.na(.data[[variavel]]))\n  formula <- as.formula(paste(variavel, \"~ tratamento\"))\n  \n  modelo <- aov(formula, data = dados_var)\n  residuos <- residuals(modelo)\n  \n  # === Testes de premissas ===\n  shapiro_result <- shapiro.test(residuos)\n  levene_result <- leveneTest(formula, data = dados_var)\n  \n  shapiro_p <- shapiro_result$p.value\n  levene_p <- levene_result$`Pr(>F)`[1]\n\n  cat(\"\\n=== An√°lise para\", variavel, \"===\\n\")\n  cat(\"‚Üí Teste de Normalidade (Shapiro-Wilk):\\n\")\n  print(shapiro_result)\n\n  cat(\"\\n‚Üí Teste de Homocedasticidade (Levene):\\n\")\n  print(levene_result)\n\n  # === Diagn√≥stico visual dos res√≠duos ===\n  cat(\"\\n‚Üí Gr√°ficos de diagn√≥stico dos res√≠duos\\n\")\n  par(mfrow = c(1, 2))\n  plot(residuos, main = paste(\"Res√≠duos -\", variavel), ylab = \"Res√≠duos\")\n  abline(h = 0, col = \"red\", lty = 2)\n  qqnorm(residuos, main = paste(\"QQ-Plot -\", variavel))\n  qqline(residuos, col = \"red\")\n  par(mfrow = c(1, 1))\n\n  # Caminho 1: Premissas atendidas ‚Üí Scott-Knott\n  if (shapiro_p > 0.05 & levene_p > 0.05) {\n    cat(\"\\n‚Üí Premissas atendidas: usando ANOVA + Scott-Knott\\n\")\n    print(summary(modelo))\n    \n    scott <- agricolae::scott.test(modelo, \"tratamento\", group = TRUE, console = TRUE)\n    \n    letras_df <- scott$groups %>%\n      mutate(tratamento = rownames(.)) %>%\n      select(tratamento, grupo = groups)\n  \n  # Caminho 2: Premissas violadas ‚Üí Kruskal + Dunn\n  } else {\n    cat(\"\\n‚Üí Premissas violadas: usando Kruskal-Wallis + Dunn\\n\")\n    kruskal_res <- kruskal.test(formula, data = dados_var)\n    print(kruskal_res)\n    \n    dunn <- dunnTest(formula, data = dados_var, method = \"bonferroni\")\n    comp <- dunn$res\n    \n    tratamentos <- levels(dados_var$tratamento)\n    p_mat <- matrix(NA, nrow=length(tratamentos), ncol=length(tratamentos),\n                    dimnames = list(tratamentos, tratamentos))\n    \n    for (i in 1:nrow(comp)) {\n      pares <- strsplit(as.character(comp$Comparison[i]), \" - \")[[1]]\n      p_valor <- comp$P.adj[i]\n      p_mat[pares[1], pares[2]] <- p_valor\n      p_mat[pares[2], pares[1]] <- p_valor\n    }\n    \n    letras <- multcompLetters(p_mat, threshold = 0.05)\n    letras_df <- data.frame(tratamento = names(letras$Letters),\n                            grupo = letras$Letters)\n  }\n\n  # === Calcular m√©dias e unir com grupos ===\n  medias <- dados_var %>%\n    group_by(tratamento) %>%\n    summarise(media = mean(.data[[variavel]], na.rm = TRUE)) %>%\n    left_join(letras_df, by = \"tratamento\")\n\n  # === Identificar grupos √∫nicos e marcar com asterisco ===\n  grupo_freq <- table(medias$grupo)\n  medias <- medias %>%\n    mutate(asterisco = ifelse(grupo_freq[grupo] == 1, \"*\", \"\"))\n\n  # === Ordenar tratamentos por m√©dia decrescente ===\n  medias <- medias %>%\n    arrange(desc(media)) %>%\n    mutate(tratamento = factor(tratamento, levels = tratamento))\n\n  # === Marcar tratamentos relacionados ao controle negativo (cn) ===\n  grupo_cn <- medias %>% filter(tratamento == \"CN\") %>% pull(grupo)\n\n  medias <- medias %>%\n    mutate(\n      destaque = case_when(\n        tratamento == \"cn\" ~ \"Controle Negativo\",\n        grupo == grupo_cn  ~ \"Mesmo Grupo que CN\",\n        TRUE               ~ \"Outros\"\n      )\n    )\n\n  # === Cores espec√≠ficas para destaque ===\n  cores_destaque <- c(\n    \"Controle Negativo\" = \"#D73027\",      # vermelho\n    \"Mesmo Grupo que CN\" = \"#FC8D59\",     # laranja claro\n    \"Outros\" = \"#91BFDB\"                  # azul claro\n  )\n\n  # === Gr√°fico ===\n  grafico <- ggplot(medias, aes(x = tratamento, y = media, fill = destaque)) +\n    geom_col(width = 0.7) +\n    geom_text(aes(label = asterisco), vjust = -0.8, size = 6, color = \"black\") +\n    scale_fill_manual(values = cores_destaque) +\n    labs(\n      title = paste(\"M√©dia de\", y_label, \"por Tratamento\"),\n      x = \"Tratamento\",\n      y = y_label,\n      fill = \"Destaque\"\n    ) +\n    coord_flip() +\n    theme_minimal() +\n    theme(\n      text = element_text(size = 12),\n      plot.title = element_text(hjust = 0.5, face = \"bold\")\n    )\n\n  print(grafico)\n}\n\n# === 3. Rodar an√°lises ===\nanalise_variavel(dados, \"pm\",  \"Perda de Massa (PM)\")\nanalise_variavel(dados, \"pdr\", \"Perda de Dureza Relativa (PDR)\")\nanalise_variavel(dados, \"pds\", \"Perda de Densidade Aparente (PDS)\")\n\n```\n\nNo gr√°fico 1, o Controle Negativo ficou isolado nos grupos de significancia oque demontra uma confiabilidade na an√°lise; os fungos 24 e e 42 ambos com maior perda de massa que o controle, ficaram isolados em grupos de significancia do restante dos grupos, o fungo LT est√° isolado e, destacando-se com um valor muito acima da maioria das m√©dias dos tratamentos.\n\nNo gr√°fico 2, os tratamentos ficaram a maioria dentro do mesmo grupo de significancia do controle negativo, oque demontra que essa an√°lise √© mais sensivel, a perda de dureza est√° relacionada com a resist√™ncia mec√¢nica da madeira, ps fungos 50, 36 e 26 ficaram em outros grupos de significancia, entretanto, todos tiveram medias menores que o controle negativo. O tratamento LT pelo contr√°rio, demonstra que ficou em um grupo de significancia distinto do controle e causou a maior media de perda de dureza da madeira, essa an√°lise demontra que o fungo degradou a madeira de forma eficiente a afetar componentes estruturais que conferem resistencia a madeira.\n\nNo gr√°fico 3, nota-se que o controle negativo assim como no gr√°fico da perda de massa ficou isolado em um grupo de significancia, os tratamentos que ficaram isolados dos demais com medias acima do CN foram: 53, 27, 24 e 42, em rela√ß√£o a maior m√©dia o fungo LT continua apresentando os melhores resultados. Em conformidade com todas as an√°lises.\n","srcMarkdownNoYaml":"\n\n# AN√ÅLISE ESTAT√çSTICA PARA AS ATIVIDADES ENZIM√ÅTICAS\n\n## Delineamento Experimental e Conjunto de dados:\n\nNossos dados comportam a atividade enzim√°tica da cole√ß√£o f√∫ngica CMPC coletados no Sul do Brasil.\n\n-   A planilha excel cont√©m dados de 53 isolados induzidos em 3 diferentes substratos, dos quais vamos quantificar a express√£o de 7 enzimas.\n-   2 r√©plicas por isolado, cada uma com 3 erlenmeyers.\n\n# üìä Metodologia estat√≠stica aplicada:\n\n## Sele√ß√£o dos melhores produtores utilizando apenas m√©dia simples\n\nEssa sele√ß√£o foi feita utilizando apenas as maiores atividades m√©dias por enzima desconsiderando o fator biomassa:\n\nEsse c√≥digo exporta a tabela de maiores m√©dias demonstrando (enzima + isolado + m√©dia de atividade+ biomassa) + gr√°fico de barras empilhadas por enzima analisada.\n\n```{r}\n# Carregar pacotes necess√°rios\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(openxlsx)\n\n# Ler os dados\ndados <- read_excel(\"at_enz.xlsx\")\n\n# Calcular m√©dia de atividade por Enzima, Isolado e Biomassa\nmedia_atividade_com_biomassa <- dados %>%\n  group_by(Enzima, Isolado, Biomassa) %>%\n  summarise(Media_Atividade = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n\n# Calcular a m√©dia geral por Enzima e Isolado (sem considerar biomassa)\nmedia_atividade <- media_atividade_com_biomassa %>%\n  group_by(Enzima, Isolado) %>%\n  summarise(Media_Atividade = mean(Media_Atividade), .groups = \"drop\")\n\n# Selecionar top 3 isolados por enzima\ntop_isolados <- media_atividade %>%\n  group_by(Enzima) %>%\n  slice_max(order_by = Media_Atividade, n = 3) %>%\n  arrange(Enzima, desc(Media_Atividade)) %>%\n  ungroup()\n\n# Para cada top isolado, identificar qual biomassa teve maior m√©dia\nbiomassa_destaque <- media_atividade_com_biomassa %>%\n  semi_join(top_isolados, by = c(\"Enzima\", \"Isolado\")) %>%\n  group_by(Enzima, Isolado) %>%\n  slice_max(order_by = Media_Atividade, n = 1) %>%\n  select(Enzima, Isolado, Biomassa)\n\n# Juntar com a tabela final\nresultado_final <- top_isolados %>%\n  left_join(biomassa_destaque, by = c(\"Enzima\", \"Isolado\"))\n\n# Exportar para Excel\nwrite.xlsx(resultado_final, \"top_isolados_com_biomassa_destaque.xlsx\")\n\n# Criar gr√°ficos para cada enzima\nenzimas <- unique(dados$Enzima)\n\ndir.create(\"graficos\", showWarnings = FALSE)  # Pasta para salvar os gr√°ficos\n\nfor (enz in enzimas) {\n  dados_grafico <- dados %>%\n    filter(Enzima == enz) %>%\n    group_by(Isolado, Biomassa) %>%\n    summarise(Media = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n  \n  p <- ggplot(dados_grafico, aes(x = factor(Isolado), y = Media, fill = Biomassa)) +\n    geom_bar(stat = \"identity\", position = \"stack\") +\n    labs(title = paste(\"Atividade m√©dia por biomassa -\", enz),\n         x = \"Isolado\",\n         y = \"Atividade M√©dia\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  \n  # Salvar gr√°fico\n  ggsave(filename = paste0(\"graficos/\", enz, \"_grafico.png\"),\n         plot = p, width = 8, height = 5)\n}\n\n```\n\n## Sele√ß√£o utilizando estat√≠stica robusta e compara√ß√£o de m√©dias\n\nEsse c√≥digo:\n\n-   Faz an√°lise para cada enzima.\n\n-   Detecta se ANOVA+Tukey ou Kruskal+Dunn √© adequado.\n\n-   Seleciona top 5 isolados (baseado na m√©dia da melhor biomassa).\n\n-   No gr√°fico, barras s√£o coloridas pela biomassa da melhor m√©dia.\n\n-   Asterisco vermelho indica isolados significativamente diferentes do melhor isolado.\n\n-   Exporta uma tabela com isolado, biomassa, m√©dia e asterisco.\n\n```{r}\n# Pacotes necess√°rios\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(rstatix)\nlibrary(ggplot2)\nlibrary(openxlsx)\nlibrary(patchwork)\n\n# Ler os dados\ndados <- read_excel(\"at_enz.xlsx\")\n\n# Converter vari√°veis para fator\ndados <- dados %>%\n  mutate(\n    Enzima = as.factor(Enzima),\n    Isolado = as.factor(Isolado),\n    Biomassa = as.factor(Biomassa),\n    Tubo = as.factor(Tubo),\n    Repeticao = as.factor(Repeticao)\n  )\n\n# Objeto para armazenar os melhores isolados por estat√≠stica e biomassa\ntabela_melhores <- data.frame()\n\n# Loop por enzima\nfor (enzima in unique(dados$Enzima)) {\n  cat(\"\\n\\n===== Enzima:\", enzima, \"=====\\n\")\n  \n  subdados <- dados %>% filter(Enzima == enzima)\n  \n  # Calcular m√©dia da atividade por Isolado e Biomassa\n  medias <- subdados %>%\n    group_by(Isolado, Biomassa) %>%\n    summarise(Media_Atividade = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n  \n  # Para cada isolado, escolher a biomassa com maior m√©dia\n  melhores <- medias %>%\n    group_by(Isolado) %>%\n    slice_max(order_by = Media_Atividade, n = 1) %>%\n    ungroup()\n  \n  # Ordenar pelo topo 5 isolados\n  melhores <- melhores %>%\n    arrange(desc(Media_Atividade)) %>%\n    slice_head(n = 5)\n  \n  # Teste de normalidade\n  shapiro_p <- tryCatch({\n    shapiro_test(subdados, Atividade)$p\n  }, error = function(e) {\n    NA\n  })\n  \n  # Teste de homogeneidade de vari√¢ncias (Levene)\n  levene_p <- tryCatch({\n    levene_test(subdados, Atividade ~ Isolado)$p\n  }, error = function(e) {\n    NA\n  })\n  \n  cat(\"Shapiro-Wilk p-valor:\", shapiro_p, \"\\n\")\n  cat(\"Levene p-valor:\", levene_p, \"\\n\")\n  \n  if (!is.na(shapiro_p) && !is.na(levene_p) && shapiro_p > 0.05 && levene_p > 0.05) {\n    cat(\"‚Üí Dados normais e homog√™neos: ANOVA + Tukey\\n\")\n    \n    anova <- aov(Atividade ~ Isolado, data = subdados)\n    tukey <- TukeyHSD(anova)\n    \n    tukey_df <- as.data.frame(tukey$Isolado)\n    tukey_df$Comparacao <- rownames(tukey_df)\n    \n    melhor_isolado <- melhores$Isolado[1]\n    \n    # Isolados que diferem significativamente do melhor isolado\n    comparacoes_relevantes <- tukey_df %>%\n      filter(grepl(melhor_isolado, Comparacao)) %>%\n      mutate(\n        outro_isolado = ifelse(grepl(melhor_isolado, Comparacao),\n                              sub(\".*-\", \"\", Comparacao),\n                              sub(\"-.*\", \"\", Comparacao)),\n        signif = `p.adj` < 0.05\n      )\n    \n    isolados_significativos <- comparacoes_relevantes %>%\n      filter(signif == TRUE) %>%\n      pull(outro_isolado) %>%\n      unique()\n    \n    melhores <- melhores %>%\n      mutate(asterisco = ifelse(Isolado %in% isolados_significativos, \"*\", \"\"))\n    \n  } else {\n    cat(\"‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\\n\")\n    \n    kruskal <- kruskal_test(subdados, Atividade ~ Isolado)\n    print(kruskal)\n    \n    dunn <- dunn_test(subdados, Atividade ~ Isolado, p.adjust.method = \"bonferroni\")\n    \n    melhor_isolado <- melhores$Isolado[1]\n    \n    # Isolados que diferem significativamente do melhor isolado (p.adj < 0.05)\n    isolados_significativos <- dunn %>%\n      filter((group1 == melhor_isolado | group2 == melhor_isolado) & p.adj < 0.05) %>%\n      mutate(outro_isolado = ifelse(group1 == melhor_isolado, group2, group1)) %>%\n      pull(outro_isolado) %>%\n      unique()\n    \n    melhores <- melhores %>%\n      mutate(asterisco = ifelse(Isolado %in% isolados_significativos, \"*\", \"\"))\n  }\n  \n  # Gr√°fico\n  p <- ggplot(melhores, aes(x = reorder(Isolado, -Media_Atividade), y = Media_Atividade, fill = Biomassa)) +\n    geom_col() +\n    geom_text(aes(label = asterisco), vjust = -0.5, size = 8, color = \"red\") +\n    labs(title = paste(\"Top 5 Isolados -\", enzima),\n         x = \"Isolado\", y = \"M√©dia de Atividade\", fill = \"Biomassa\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  \n  print(p)\n  \n  # Adicionar coluna de enzima para exporta√ß√£o\n  melhores$Enzima <- enzima\n  \n  # Juntar na tabela final\n  tabela_melhores <- bind_rows(tabela_melhores, melhores)\n}\n\n# Exportar tabela final com melhores isolados, biomassa e indica√ß√£o de signific√¢ncia\nwrite.xlsx(tabela_melhores, \"melhores_isolados_por_estatistica.xlsx\", rownames = FALSE)\n\n\n```\n\n## Visualiza√ß√£o dos melhores isolados\n\nEsse c√≥digo cria um gr√°fico facetado com as m√©dias dos melhores isolados por enzima.\n\n```{r}\n\n# Gr√°fico facetado com todos os melhores isolados\nlibrary(readxl)\nlibrary(ggplot2)\n\n# Ler arquivo Excel - substitua \"dados.xlsx\" pelo nome do seu arquivo\ndf <- read_excel(\"melhores_isolados_por_estatistica.xlsx\")\n\n# Mostrar as primeiras linhas para conferir os dados\nhead(df)\n\n# Criar gr√°fico de barras facetado com eixos independentes\nnomes_enzyme <- c(\n  \"xil\" = \"Xilanase\",\n  \"endog\" = \"Endoglucanase\",\n  \"fpa\" = \"FPase\",\n  \"lac\" = \"Lacase\",\n  \"bgli\" = \"Œ≤ glicosidase\",\n  \"bxil\" = \"Œ≤ xilosidase\",\n  \"mangper\" = \"Mangan√™s peroxidase\"\n)\n\nggplot(df, aes(x = Isolado, y = Media_Atividade, fill = Biomassa)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.8)) +\n  facet_wrap(~ Enzima, scales = \"free\", labeller = labeller(Enzima = nomes_enzyme)) +\n  labs(\n    title = \"M√©dias agrupadas por Biomassa\",\n    fill = \"Biomassa\",\n    caption = \"Fonte: Elaborado pela autora, 2025.\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n\n```\n\n## Visualiza√ß√£o da identifica√ß√£o a nivel de g√™nero\n\nQuanto a identifica√ß√£o a nivel de g√™nero:\n\n```{r}\n# Instalar pacotes, se ainda n√£o tiver\nif (!require(readxl)) install.packages(\"readxl\")\nif (!require(ggplot2)) install.packages(\"ggplot2\")\n\nlibrary(readxl)\nlibrary(ggplot2)\n\n# 1. Carregar o arquivo Excel\n# Substitua \"arquivo.xlsx\" pelo nome real do seu arquivo\ndados_tax <- read_excel(\"cap1.xlsx\", sheet = 2)\n\n# 2. Verificar as colunas (opcional)\nhead(dados_tax)\ncolnames(dados_tax)\n\n# 3. Calcular a frequ√™ncia dos filos\nfreq_ordem <- as.data.frame(table(dados_tax$ordem))\ncolnames(freq_ordem) <- c(\"ordem\", \"frequencia\")\n\n# 4. Calcular a porcentagem\nfreq_ordem$porcentagem <- round(100 * freq_ordem$frequencia / sum(freq_ordem$frequencia), 1)\n\n# 5. Criar r√≥tulo para a legenda\nfreq_ordem$label <- paste0(freq_ordem$ordem, \" (\", freq_ordem$porcentagem, \"%)\")\n\n# 6. Gerar o gr√°fico de pizza\nggplot(freq_ordem, aes(x = \"\", y = frequencia, fill = label)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(\"y\", start = 0) +\n  labs(caption = \"Fonte: Betim, 2025.\") +\n  theme_void() +\n  theme(legend.position = \"right\") +\n  guides(fill = guide_legend(title = \"Ordem\"))\n\n\n```\n\n# ANALISE ESTAT√çSTICA PARA A BIODEGRADA√á√ÉO ACELERADA\n\n## Delineamento Experimental e Conjunto de Dados\n\nNossos dados comportam dados das propriedades fisicas da madeira degradada com isolados selecionados na cole√ß√£o f√∫ngica CMPC coletados no Sul do Brasil.\n\n-   A planilha excel cont√©m dados de 23 isolados induzidos em 3 diferentes substratos, dos quais vamos quantificar a perda de massa, a perda de dureza em rela√ß√£o ao controle negativo e a perda de densidade aparente;\n-   3 r√©plicas por isolado, cada uma com 3 cavacos.\n\n### üìå‚úÖ **O que esse script faz?**\n\n1.  **Carregamento de pacotes** apropriados para an√°lise estat√≠stica e visualiza√ß√£o.\n\n2.  **Importa√ß√£o de dados** do Excel.\n\n3.  **Fun√ß√£o gen√©rica** que: executa ANOVA, realiza o teste de Tukey, se todas as premissas forem atendidas, e no caso de violadas executa teste n√£o param√©trico, extrai letras de signific√¢ncia com `multcompLetters4`, gera gr√°fico de barras com m√©dias e letras.\n\n4.  **Execu√ß√£o da fun√ß√£o** para m√∫ltiplas vari√°veis com diferentes r√≥tulos de eixo Y.\n\n```{# === 0. Carregar pacotes ===}\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(multcompView)\nlibrary(agricolae)\nlibrary(FSA)\nlibrary(car)\nlibrary(Polychrome)\n\n# === 1. Carregar os dados ===\ndados <- read_excel(\"teste_deg.xlsx\")\ndados$tratamento <- as.factor(dados$tratamento)\n\n# === 2. Fun√ß√£o de an√°lise completa ===\nanalise_variavel <- function(dados, variavel, y_label) {\n  dados_var <- dados %>% filter(!is.na(.data[[variavel]]))\n  formula <- as.formula(paste(variavel, \"~ tratamento\"))\n  \n  modelo <- aov(formula, data = dados_var)\n  residuos <- residuals(modelo)\n  \n  # === Testes de premissas ===\n  shapiro_result <- shapiro.test(residuos)\n  levene_result <- leveneTest(formula, data = dados_var)\n  \n  shapiro_p <- shapiro_result$p.value\n  levene_p <- levene_result$`Pr(>F)`[1]\n\n  cat(\"\\n=== An√°lise para\", variavel, \"===\\n\")\n  cat(\"‚Üí Teste de Normalidade (Shapiro-Wilk):\\n\")\n  print(shapiro_result)\n\n  cat(\"\\n‚Üí Teste de Homocedasticidade (Levene):\\n\")\n  print(levene_result)\n\n  # === Diagn√≥stico visual dos res√≠duos ===\n  cat(\"\\n‚Üí Gr√°ficos de diagn√≥stico dos res√≠duos\\n\")\n  par(mfrow = c(1, 2))\n  plot(residuos, main = paste(\"Res√≠duos -\", variavel), ylab = \"Res√≠duos\")\n  abline(h = 0, col = \"red\", lty = 2)\n  qqnorm(residuos, main = paste(\"QQ-Plot -\", variavel))\n  qqline(residuos, col = \"red\")\n  par(mfrow = c(1, 1))\n\n  # Caminho 1: Premissas atendidas ‚Üí Scott-Knott\n  if (shapiro_p > 0.05 & levene_p > 0.05) {\n    cat(\"\\n‚Üí Premissas atendidas: usando ANOVA + Scott-Knott\\n\")\n    print(summary(modelo))\n    \n    scott <- agricolae::scott.test(modelo, \"tratamento\", group = TRUE, console = TRUE)\n    \n    letras_df <- scott$groups %>%\n      mutate(tratamento = rownames(.)) %>%\n      select(tratamento, grupo = groups)\n  \n  # Caminho 2: Premissas violadas ‚Üí Kruskal + Dunn\n  } else {\n    cat(\"\\n‚Üí Premissas violadas: usando Kruskal-Wallis + Dunn\\n\")\n    kruskal_res <- kruskal.test(formula, data = dados_var)\n    print(kruskal_res)\n    \n    dunn <- dunnTest(formula, data = dados_var, method = \"bonferroni\")\n    comp <- dunn$res\n    \n    tratamentos <- levels(dados_var$tratamento)\n    p_mat <- matrix(NA, nrow=length(tratamentos), ncol=length(tratamentos),\n                    dimnames = list(tratamentos, tratamentos))\n    \n    for (i in 1:nrow(comp)) {\n      pares <- strsplit(as.character(comp$Comparison[i]), \" - \")[[1]]\n      p_valor <- comp$P.adj[i]\n      p_mat[pares[1], pares[2]] <- p_valor\n      p_mat[pares[2], pares[1]] <- p_valor\n    }\n    \n    letras <- multcompLetters(p_mat, threshold = 0.05)\n    letras_df <- data.frame(tratamento = names(letras$Letters),\n                            grupo = letras$Letters)\n  }\n\n  # === Calcular m√©dias e unir com grupos ===\n  medias <- dados_var %>%\n    group_by(tratamento) %>%\n    summarise(media = mean(.data[[variavel]], na.rm = TRUE)) %>%\n    left_join(letras_df, by = \"tratamento\")\n\n  # === Identificar grupos √∫nicos e marcar com asterisco ===\n  grupo_freq <- table(medias$grupo)\n  medias <- medias %>%\n    mutate(asterisco = ifelse(grupo_freq[grupo] == 1, \"*\", \"\"))\n\n  # === Ordenar tratamentos por m√©dia decrescente ===\n  medias <- medias %>%\n    arrange(desc(media)) %>%\n    mutate(tratamento = factor(tratamento, levels = tratamento))\n\n  # === Cores com Polychrome (36 cores com alto contraste) ===\n  grupos_unicos <- sort(unique(medias$grupo))\n  paleta <- palette36.colors(length(grupos_unicos))\n  cores <- setNames(paleta, grupos_unicos)\n\n  # === Gr√°fico ===\n  grafico <- ggplot(medias, aes(x = tratamento, y = media, fill = grupo)) +\n    geom_col(width = 0.7) +\n    geom_text(aes(label = asterisco), vjust = -0.8, size = 6, color = \"black\") +\n    scale_fill_manual(values = cores) +\n    labs(\n      title = paste(\"M√©dia de\", y_label, \"por Tratamento\"),\n      x = \"Tratamento\",\n      y = y_label,\n      fill = \"Grupo\"\n    ) +\n    coord_flip() +\n    theme_minimal() +\n    theme(\n      text = element_text(size = 12),\n      plot.title = element_text(hjust = 0.5, face = \"bold\")\n    )\n  \n  print(grafico)\n}\n\n# === 3. Rodar an√°lises ===\nanalise_variavel(dados, \"pm\",  \"Perda de Massa (PM)\")\nanalise_variavel(dados, \"pdr\", \"Perda de Dureza Relativa (PDR)\")\nanalise_variavel(dados, \"pds\", \"Perda de Densidade Aparente (PDS)\")\n\n\n```\n\n### üìå **1. Vari√°vel: `pm` ‚Äì Perda de Massa**\n\n-   **Shapiro-Wilk**:\n\n```         \n-    W = 0.94606  -    p = **3.228e-08** ‚Üí ‚ùå Viola√ß√£o da normalidade\n```\n\n-   **Levene (homocedasticidade)**:\n\n```         \n-    F = 4.3557  -    p = **2.154e-09** ‚Üí ‚ùå Viola√ß√£o da homogeneidade de vari√¢ncias\n```\n\n-   **Decis√£o**: Premissas violadas ‚Üí Kruskal-Wallis + Dunn\n\n-   **Kruskal-Wallis**:\n\n```         \n-    œá¬≤ = 109.39, gl = 23  -    p = **3.229e-13** ‚Üí ‚úÖ Diferen√ßa significativa entre tratamentos\n```\n\n### üìå **2. Vari√°vel: `pdr` ‚Äì Perda de Dureza Relativa**\n\n-   **Shapiro-Wilk**:\n\n```         \n-    W = 0.93213  -   p = **1.413e-09** ‚Üí ‚ùå Viola√ß√£o da normalidade\n```\n\n-   **Levene**:\n\n```         \n-    F = 0.8714  -    p = **0.6371** ‚Üí ‚úÖ Homocedasticidade aceita\n```\n\n-   **Decis√£o**: Mesmo com vari√¢ncias homog√™neas, a normalidade foi violada ‚Üí Kruskal-Wallis + Dunn\n\n-   **Kruskal-Wallis**:\n\n```         \n-    œá¬≤ = 36.85, gl = 23  -    p = **0.0337** ‚Üí ‚úÖ Diferen√ßa significativa (moderada)\n```\n\n### üìå **3. Vari√°vel: `pds` ‚Äì Perda de Densidade Aparente**\n\n-   **Shapiro-Wilk**:\n\n```         \n-    W = 0.94844  -    p = **6.066e-08** ‚Üí ‚ùå Viola√ß√£o da normalidade\n```\n\n-   **Levene**:\n\n```         \n-    F = 5.0554  -    p = **2.486e-11** ‚Üí ‚ùå Viola√ß√£o da homocedasticidade\n```\n\n-   **Decis√£o**: Premissas violadas ‚Üí Kruskal-Wallis + Dunn\n\n-   **Kruskal-Wallis**:\n\n```         \n-    œá¬≤ = 108.57, gl = 23  -    p = **4.509e-13** ‚Üí ‚úÖ Diferen√ßa altamente significativa\n```\n\n## üß™ **Conclus√£o T√©cnica**\n\n| Vari√°vel | Normalidade | Homocedasticidade | Teste Utilizado | Resultado |\n|---------------|---------------|---------------|---------------|---------------|\n| `pm` | ‚ùå | ‚ùå | Kruskal-Wallis + Dunn | **Significativo** |\n| `pdr` | ‚ùå | ‚úÖ | Kruskal-Wallis + Dunn | **Significativo** |\n| `pds` | ‚ùå | ‚ùå | Kruskal-Wallis + Dunn | **Significativo** |\n\n## üìå Observa√ß√£o\n\n-   **Premissas violadas** ‚Üí teste **n√£o param√©trico**.\n\n-   O script est√° **automatizado, robusto e confi√°vel**.\n\n-   Os resultados indicam que **os tratamentos influenciam significativamente** nas tr√™s vari√°veis avaliadas.\n\n```{r}\n# === 0. Carregar pacotes ===\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(multcompView)\nlibrary(agricolae)\nlibrary(FSA)\nlibrary(car)\nlibrary(Polychrome)\n\n# === 1. Carregar os dados ===\ndados <- read_excel(\"teste_deg.xlsx\")\ndados$tratamento <- as.factor(dados$tratamento)\n\n# === 2. Fun√ß√£o de an√°lise completa ===\nanalise_variavel <- function(dados, variavel, y_label) {\n  dados_var <- dados %>% filter(!is.na(.data[[variavel]]))\n  formula <- as.formula(paste(variavel, \"~ tratamento\"))\n  \n  modelo <- aov(formula, data = dados_var)\n  residuos <- residuals(modelo)\n  \n  # === Testes de premissas ===\n  shapiro_result <- shapiro.test(residuos)\n  levene_result <- leveneTest(formula, data = dados_var)\n  \n  shapiro_p <- shapiro_result$p.value\n  levene_p <- levene_result$`Pr(>F)`[1]\n\n  cat(\"\\n=== An√°lise para\", variavel, \"===\\n\")\n  cat(\"‚Üí Teste de Normalidade (Shapiro-Wilk):\\n\")\n  print(shapiro_result)\n\n  cat(\"\\n‚Üí Teste de Homocedasticidade (Levene):\\n\")\n  print(levene_result)\n\n  # === Diagn√≥stico visual dos res√≠duos ===\n  cat(\"\\n‚Üí Gr√°ficos de diagn√≥stico dos res√≠duos\\n\")\n  par(mfrow = c(1, 2))\n  plot(residuos, main = paste(\"Res√≠duos -\", variavel), ylab = \"Res√≠duos\")\n  abline(h = 0, col = \"red\", lty = 2)\n  qqnorm(residuos, main = paste(\"QQ-Plot -\", variavel))\n  qqline(residuos, col = \"red\")\n  par(mfrow = c(1, 1))\n\n  # Caminho 1: Premissas atendidas ‚Üí Scott-Knott\n  if (shapiro_p > 0.05 & levene_p > 0.05) {\n    cat(\"\\n‚Üí Premissas atendidas: usando ANOVA + Scott-Knott\\n\")\n    print(summary(modelo))\n    \n    scott <- agricolae::scott.test(modelo, \"tratamento\", group = TRUE, console = TRUE)\n    \n    letras_df <- scott$groups %>%\n      mutate(tratamento = rownames(.)) %>%\n      select(tratamento, grupo = groups)\n  \n  # Caminho 2: Premissas violadas ‚Üí Kruskal + Dunn\n  } else {\n    cat(\"\\n‚Üí Premissas violadas: usando Kruskal-Wallis + Dunn\\n\")\n    kruskal_res <- kruskal.test(formula, data = dados_var)\n    print(kruskal_res)\n    \n    dunn <- dunnTest(formula, data = dados_var, method = \"bonferroni\")\n    comp <- dunn$res\n    \n    tratamentos <- levels(dados_var$tratamento)\n    p_mat <- matrix(NA, nrow=length(tratamentos), ncol=length(tratamentos),\n                    dimnames = list(tratamentos, tratamentos))\n    \n    for (i in 1:nrow(comp)) {\n      pares <- strsplit(as.character(comp$Comparison[i]), \" - \")[[1]]\n      p_valor <- comp$P.adj[i]\n      p_mat[pares[1], pares[2]] <- p_valor\n      p_mat[pares[2], pares[1]] <- p_valor\n    }\n    \n    letras <- multcompLetters(p_mat, threshold = 0.05)\n    letras_df <- data.frame(tratamento = names(letras$Letters),\n                            grupo = letras$Letters)\n  }\n\n  # === Calcular m√©dias e unir com grupos ===\n  medias <- dados_var %>%\n    group_by(tratamento) %>%\n    summarise(media = mean(.data[[variavel]], na.rm = TRUE)) %>%\n    left_join(letras_df, by = \"tratamento\")\n\n  # === Identificar grupos √∫nicos e marcar com asterisco ===\n  grupo_freq <- table(medias$grupo)\n  medias <- medias %>%\n    mutate(asterisco = ifelse(grupo_freq[grupo] == 1, \"*\", \"\"))\n\n  # === Ordenar tratamentos por m√©dia decrescente ===\n  medias <- medias %>%\n    arrange(desc(media)) %>%\n    mutate(tratamento = factor(tratamento, levels = tratamento))\n\n  # === Marcar tratamentos relacionados ao controle negativo (cn) ===\n  grupo_cn <- medias %>% filter(tratamento == \"CN\") %>% pull(grupo)\n\n  medias <- medias %>%\n    mutate(\n      destaque = case_when(\n        tratamento == \"cn\" ~ \"Controle Negativo\",\n        grupo == grupo_cn  ~ \"Mesmo Grupo que CN\",\n        TRUE               ~ \"Outros\"\n      )\n    )\n\n  # === Cores espec√≠ficas para destaque ===\n  cores_destaque <- c(\n    \"Controle Negativo\" = \"#D73027\",      # vermelho\n    \"Mesmo Grupo que CN\" = \"#FC8D59\",     # laranja claro\n    \"Outros\" = \"#91BFDB\"                  # azul claro\n  )\n\n  # === Gr√°fico ===\n  grafico <- ggplot(medias, aes(x = tratamento, y = media, fill = destaque)) +\n    geom_col(width = 0.7) +\n    geom_text(aes(label = asterisco), vjust = -0.8, size = 6, color = \"black\") +\n    scale_fill_manual(values = cores_destaque) +\n    labs(\n      title = paste(\"M√©dia de\", y_label, \"por Tratamento\"),\n      x = \"Tratamento\",\n      y = y_label,\n      fill = \"Destaque\"\n    ) +\n    coord_flip() +\n    theme_minimal() +\n    theme(\n      text = element_text(size = 12),\n      plot.title = element_text(hjust = 0.5, face = \"bold\")\n    )\n\n  print(grafico)\n}\n\n# === 3. Rodar an√°lises ===\nanalise_variavel(dados, \"pm\",  \"Perda de Massa (PM)\")\nanalise_variavel(dados, \"pdr\", \"Perda de Dureza Relativa (PDR)\")\nanalise_variavel(dados, \"pds\", \"Perda de Densidade Aparente (PDS)\")\n\n```\n\nNo gr√°fico 1, o Controle Negativo ficou isolado nos grupos de significancia oque demontra uma confiabilidade na an√°lise; os fungos 24 e e 42 ambos com maior perda de massa que o controle, ficaram isolados em grupos de significancia do restante dos grupos, o fungo LT est√° isolado e, destacando-se com um valor muito acima da maioria das m√©dias dos tratamentos.\n\nNo gr√°fico 2, os tratamentos ficaram a maioria dentro do mesmo grupo de significancia do controle negativo, oque demontra que essa an√°lise √© mais sensivel, a perda de dureza est√° relacionada com a resist√™ncia mec√¢nica da madeira, ps fungos 50, 36 e 26 ficaram em outros grupos de significancia, entretanto, todos tiveram medias menores que o controle negativo. O tratamento LT pelo contr√°rio, demonstra que ficou em um grupo de significancia distinto do controle e causou a maior media de perda de dureza da madeira, essa an√°lise demontra que o fungo degradou a madeira de forma eficiente a afetar componentes estruturais que conferem resistencia a madeira.\n\nNo gr√°fico 3, nota-se que o controle negativo assim como no gr√°fico da perda de massa ficou isolado em um grupo de significancia, os tratamentos que ficaram isolados dos demais com medias acima do CN foram: 53, 27, 24 e 42, em rela√ß√£o a maior m√©dia o fungo LT continua apresentando os melhores resultados. Em conformidade com todas as an√°lises.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":false,"include-after-body":[{"text":"<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css\">\n"}],"include-in-header":[{"text":"<link href=\"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Playfair+Display:wght@700&display=swap\" rel=\"stylesheet\">\n"}],"output-file":"melhoresprodutores.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","theme":"cosmo","title":"","editor":"visual"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}