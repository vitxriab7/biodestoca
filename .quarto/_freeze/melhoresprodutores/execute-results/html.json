{
  "hash": "3811918a290d3540717c10a996227f79",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"\"\nformat: html\neditor: visual\n---\n\n\n\n\n# AN√ÅLISE ESTAT√çSTICA PARA AS ATIVIDADES ENZIM√ÅTICAS\n\n## Delineamento Experimental e Conjunto de dados:\n\nNossos dados comportam a atividade enzim√°tica da cole√ß√£o f√∫ngica CMPC coletados no Sul do Brasil.\n\n-   A planilha excel cont√©m dados de 53 isolados induzidos em 3 diferentes substratos, dos quais vamos quantificar a express√£o de 7 enzimas.\n-   2 r√©plicas por isolado, cada uma com 3 erlenmeyers.\n\n# üìä Metodologia estat√≠stica aplicada:\n\n## Sele√ß√£o dos melhores produtores utilizando apenas m√©dia simples\n\nEssa sele√ß√£o foi feita utilizando apenas as maiores atividades m√©dias por enzima desconsiderando o fator biomassa:\n\nEsse c√≥digo exporta a tabela de maiores m√©dias demonstrando (enzima + isolado + m√©dia de atividade+ biomassa) + gr√°fico de barras empilhadas por enzima analisada.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar pacotes necess√°rios\nlibrary(readxl)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAnexando pacote: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOs seguintes objetos s√£o mascarados por 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nOs seguintes objetos s√£o mascarados por 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(openxlsx)\n\n# Ler os dados\ndados <- read_excel(\"at_enz.xlsx\")\n\n# Calcular m√©dia de atividade por Enzima, Isolado e Biomassa\nmedia_atividade_com_biomassa <- dados %>%\n  group_by(Enzima, Isolado, Biomassa) %>%\n  summarise(Media_Atividade = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n\n# Calcular a m√©dia geral por Enzima e Isolado (sem considerar biomassa)\nmedia_atividade <- media_atividade_com_biomassa %>%\n  group_by(Enzima, Isolado) %>%\n  summarise(Media_Atividade = mean(Media_Atividade), .groups = \"drop\")\n\n# Selecionar top 3 isolados por enzima\ntop_isolados <- media_atividade %>%\n  group_by(Enzima) %>%\n  slice_max(order_by = Media_Atividade, n = 3) %>%\n  arrange(Enzima, desc(Media_Atividade)) %>%\n  ungroup()\n\n# Para cada top isolado, identificar qual biomassa teve maior m√©dia\nbiomassa_destaque <- media_atividade_com_biomassa %>%\n  semi_join(top_isolados, by = c(\"Enzima\", \"Isolado\")) %>%\n  group_by(Enzima, Isolado) %>%\n  slice_max(order_by = Media_Atividade, n = 1) %>%\n  select(Enzima, Isolado, Biomassa)\n\n# Juntar com a tabela final\nresultado_final <- top_isolados %>%\n  left_join(biomassa_destaque, by = c(\"Enzima\", \"Isolado\"))\n\n# Exportar para Excel\nwrite.xlsx(resultado_final, \"top_isolados_com_biomassa_destaque.xlsx\")\n\n# Criar gr√°ficos para cada enzima\nenzimas <- unique(dados$Enzima)\n\ndir.create(\"graficos\", showWarnings = FALSE)  # Pasta para salvar os gr√°ficos\n\nfor (enz in enzimas) {\n  dados_grafico <- dados %>%\n    filter(Enzima == enz) %>%\n    group_by(Isolado, Biomassa) %>%\n    summarise(Media = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n  \n  p <- ggplot(dados_grafico, aes(x = factor(Isolado), y = Media, fill = Biomassa)) +\n    geom_bar(stat = \"identity\", position = \"stack\") +\n    labs(title = paste(\"Atividade m√©dia por biomassa -\", enz),\n         x = \"Isolado\",\n         y = \"Atividade M√©dia\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  \n  # Salvar gr√°fico\n  ggsave(filename = paste0(\"graficos/\", enz, \"_grafico.png\"),\n         plot = p, width = 8, height = 5)\n}\n```\n:::\n\n\n\n\n## Sele√ß√£o utilizando estat√≠stica robusta e compara√ß√£o de m√©dias\n\nEsse c√≥digo:\n\n-   Faz an√°lise para cada enzima.\n\n-   Detecta se ANOVA+Tukey ou Kruskal+Dunn √© adequado.\n\n-   Seleciona top 5 isolados (baseado na m√©dia da melhor biomassa).\n\n-   No gr√°fico, barras s√£o coloridas pela biomassa da melhor m√©dia.\n\n-   Asterisco vermelho indica isolados significativamente diferentes do melhor isolado.\n\n-   Exporta uma tabela com isolado, biomassa, m√©dia e asterisco.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pacotes necess√°rios\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggpubr)\nlibrary(rstatix)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAnexando pacote: 'rstatix'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nO seguinte objeto √© mascarado por 'package:stats':\n\n    filter\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(openxlsx)\nlibrary(patchwork)\n\n# Ler os dados\ndados <- read_excel(\"at_enz.xlsx\")\n\n# Converter vari√°veis para fator\ndados <- dados %>%\n  mutate(\n    Enzima = as.factor(Enzima),\n    Isolado = as.factor(Isolado),\n    Biomassa = as.factor(Biomassa),\n    Tubo = as.factor(Tubo),\n    Repeticao = as.factor(Repeticao)\n  )\n\n# Objeto para armazenar os melhores isolados por estat√≠stica e biomassa\ntabela_melhores <- data.frame()\n\n# Loop por enzima\nfor (enzima in unique(dados$Enzima)) {\n  cat(\"\\n\\n===== Enzima:\", enzima, \"=====\\n\")\n  \n  subdados <- dados %>% filter(Enzima == enzima)\n  \n  # Calcular m√©dia da atividade por Isolado e Biomassa\n  medias <- subdados %>%\n    group_by(Isolado, Biomassa) %>%\n    summarise(Media_Atividade = mean(Atividade, na.rm = TRUE), .groups = \"drop\")\n  \n  # Para cada isolado, escolher a biomassa com maior m√©dia\n  melhores <- medias %>%\n    group_by(Isolado) %>%\n    slice_max(order_by = Media_Atividade, n = 1) %>%\n    ungroup()\n  \n  # Ordenar pelo topo 5 isolados\n  melhores <- melhores %>%\n    arrange(desc(Media_Atividade)) %>%\n    slice_head(n = 5)\n  \n  # Teste de normalidade\n  shapiro_p <- tryCatch({\n    shapiro_test(subdados, Atividade)$p\n  }, error = function(e) {\n    NA\n  })\n  \n  # Teste de homogeneidade de vari√¢ncias (Levene)\n  levene_p <- tryCatch({\n    levene_test(subdados, Atividade ~ Isolado)$p\n  }, error = function(e) {\n    NA\n  })\n  \n  cat(\"Shapiro-Wilk p-valor:\", shapiro_p, \"\\n\")\n  cat(\"Levene p-valor:\", levene_p, \"\\n\")\n  \n  if (!is.na(shapiro_p) && !is.na(levene_p) && shapiro_p > 0.05 && levene_p > 0.05) {\n    cat(\"‚Üí Dados normais e homog√™neos: ANOVA + Tukey\\n\")\n    \n    anova <- aov(Atividade ~ Isolado, data = subdados)\n    tukey <- TukeyHSD(anova)\n    \n    tukey_df <- as.data.frame(tukey$Isolado)\n    tukey_df$Comparacao <- rownames(tukey_df)\n    \n    melhor_isolado <- melhores$Isolado[1]\n    \n    # Isolados que diferem significativamente do melhor isolado\n    comparacoes_relevantes <- tukey_df %>%\n      filter(grepl(melhor_isolado, Comparacao)) %>%\n      mutate(\n        outro_isolado = ifelse(grepl(melhor_isolado, Comparacao),\n                              sub(\".*-\", \"\", Comparacao),\n                              sub(\"-.*\", \"\", Comparacao)),\n        signif = `p.adj` < 0.05\n      )\n    \n    isolados_significativos <- comparacoes_relevantes %>%\n      filter(signif == TRUE) %>%\n      pull(outro_isolado) %>%\n      unique()\n    \n    melhores <- melhores %>%\n      mutate(asterisco = ifelse(Isolado %in% isolados_significativos, \"*\", \"\"))\n    \n  } else {\n    cat(\"‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\\n\")\n    \n    kruskal <- kruskal_test(subdados, Atividade ~ Isolado)\n    print(kruskal)\n    \n    dunn <- dunn_test(subdados, Atividade ~ Isolado, p.adjust.method = \"bonferroni\")\n    \n    melhor_isolado <- melhores$Isolado[1]\n    \n    # Isolados que diferem significativamente do melhor isolado (p.adj < 0.05)\n    isolados_significativos <- dunn %>%\n      filter((group1 == melhor_isolado | group2 == melhor_isolado) & p.adj < 0.05) %>%\n      mutate(outro_isolado = ifelse(group1 == melhor_isolado, group2, group1)) %>%\n      pull(outro_isolado) %>%\n      unique()\n    \n    melhores <- melhores %>%\n      mutate(asterisco = ifelse(Isolado %in% isolados_significativos, \"*\", \"\"))\n  }\n  \n  # Gr√°fico\n  p <- ggplot(melhores, aes(x = reorder(Isolado, -Media_Atividade), y = Media_Atividade, fill = Biomassa)) +\n    geom_col() +\n    geom_text(aes(label = asterisco), vjust = -0.5, size = 8, color = \"red\") +\n    labs(title = paste(\"Top 5 Isolados -\", enzima),\n         x = \"Isolado\", y = \"M√©dia de Atividade\", fill = \"Biomassa\") +\n    theme_minimal() +\n    theme(axis.text.x = element_text(angle = 45, hjust = 1))\n  \n  print(p)\n  \n  # Adicionar coluna de enzima para exporta√ß√£o\n  melhores$Enzima <- enzima\n  \n  # Juntar na tabela final\n  tabela_melhores <- bind_rows(tabela_melhores, melhores)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n===== Enzima: bgli =====\nShapiro-Wilk p-valor: 1.546154e-40 \nLevene p-valor: 4.39462e-38 \n‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\n# A tibble: 1 √ó 6\n  .y.           n statistic    df        p method        \n* <chr>     <int>     <dbl> <int>    <dbl> <chr>         \n1 Atividade   954      277.    52 2.16e-32 Kruskal-Wallis\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n===== Enzima: xil =====\nShapiro-Wilk p-valor: 1.093811e-42 \nLevene p-valor: 2.79013e-60 \n‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\n# A tibble: 1 √ó 6\n  .y.           n statistic    df        p method        \n* <chr>     <int>     <dbl> <int>    <dbl> <chr>         \n1 Atividade   954      389.    52 4.30e-53 Kruskal-Wallis\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n===== Enzima: endog =====\nShapiro-Wilk p-valor: 1.553732e-40 \nLevene p-valor: 1.206932e-42 \n‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\n# A tibble: 1 √ó 6\n  .y.           n statistic    df        p method        \n* <chr>     <int>     <dbl> <int>    <dbl> <chr>         \n1 Atividade   954      217.    52 4.31e-22 Kruskal-Wallis\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n===== Enzima: lac =====\nShapiro-Wilk p-valor: 1.217409e-51 \nLevene p-valor: 1.166308e-48 \n‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\n# A tibble: 1 √ó 6\n  .y.           n statistic    df        p method        \n* <chr>     <int>     <dbl> <int>    <dbl> <chr>         \n1 Atividade   954      514.    52 2.90e-77 Kruskal-Wallis\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n===== Enzima: fpa =====\nShapiro-Wilk p-valor: 3.227648e-28 \nLevene p-valor: 3.847841e-15 \n‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\n# A tibble: 1 √ó 6\n  .y.           n statistic    df       p method        \n* <chr>     <int>     <dbl> <int>   <dbl> <chr>         \n1 Atividade   954      182.    52 2.3e-16 Kruskal-Wallis\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-2-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n===== Enzima: bxil =====\nShapiro-Wilk p-valor: 2.775456e-50 \nLevene p-valor: 6.824607e-83 \n‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\n# A tibble: 1 √ó 6\n  .y.           n statistic    df        p method        \n* <chr>     <int>     <dbl> <int>    <dbl> <chr>         \n1 Atividade   954      357.    52 5.36e-47 Kruskal-Wallis\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-2-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\n===== Enzima: mangper =====\nShapiro-Wilk p-valor: 2.201043e-49 \nLevene p-valor: 1.961586e-30 \n‚Üí Dados n√£o normais e/ou heterog√™neos: Kruskal-Wallis + Dunn\n# A tibble: 1 √ó 6\n  .y.           n statistic    df        p method        \n* <chr>     <int>     <dbl> <int>    <dbl> <chr>         \n1 Atividade   954      183.    52 1.63e-16 Kruskal-Wallis\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-2-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# Exportar tabela final com melhores isolados, biomassa e indica√ß√£o de signific√¢ncia\nwrite.xlsx(tabela_melhores, \"melhores_isolados_por_estatistica.xlsx\", rownames = FALSE)\n```\n:::\n\n\n\n\n## Visualiza√ß√£o dos melhores isolados\n\nEsse c√≥digo cria um gr√°fico facetado com as m√©dias dos melhores isolados por enzima.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gr√°fico facetado com todos os melhores isolados\nlibrary(readxl)\nlibrary(ggplot2)\n\n# Ler arquivo Excel - substitua \"dados.xlsx\" pelo nome do seu arquivo\ndf <- read_excel(\"melhores_isolados_por_estatistica.xlsx\")\n\n# Mostrar as primeiras linhas para conferir os dados\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 5\n  Isolado Biomassa Media_Atividade asterisco Enzima\n  <chr>   <chr>              <dbl> <chr>     <chr> \n1 24      FT                  5.87 <NA>      bgli  \n2 1       FT                  3.77 <NA>      bgli  \n3 4       FT                  3.10 <NA>      bgli  \n4 51      FT                  2.74 <NA>      bgli  \n5 44      FT                  2.47 <NA>      bgli  \n6 24      CS                110.   <NA>      xil   \n```\n\n\n:::\n\n```{.r .cell-code}\n# Criar gr√°fico de barras facetado com eixos independentes\nnomes_enzyme <- c(\n  \"xil\" = \"Xilanase\",\n  \"endog\" = \"Endoglucanase\",\n  \"fpa\" = \"FPase\",\n  \"lac\" = \"Lacase\",\n  \"bgli\" = \"Œ≤ glicosidase\",\n  \"bxil\" = \"Œ≤ xilosidase\",\n  \"mangper\" = \"Mangan√™s peroxidase\"\n)\n\nggplot(df, aes(x = Isolado, y = Media_Atividade, fill = Biomassa)) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.8)) +\n  facet_wrap(~ Enzima, scales = \"free\", labeller = labeller(Enzima = nomes_enzyme)) +\n  labs(\n    title = \"M√©dias agrupadas por Biomassa\",\n    fill = \"Biomassa\",\n    caption = \"Fonte: Elaborado pela autora, 2025.\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n## Visualiza√ß√£o da identifica√ß√£o a nivel de g√™nero\n\nQuanto a identifica√ß√£o a nivel de g√™nero:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Instalar pacotes, se ainda n√£o tiver\nif (!require(readxl)) install.packages(\"readxl\")\nif (!require(ggplot2)) install.packages(\"ggplot2\")\n\nlibrary(readxl)\nlibrary(ggplot2)\n\n# 1. Carregar o arquivo Excel\n# Substitua \"arquivo.xlsx\" pelo nome real do seu arquivo\ndados_tax <- read_excel(\"cap1.xlsx\", sheet = 2)\n\n# 2. Verificar as colunas (opcional)\nhead(dados_tax)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 11\n     id reino  subreino filo     subfilo classe subclasse ordem subordem familia\n  <dbl> <chr>  <chr>    <chr>    <chr>   <chr>  <chr>     <chr> <chr>    <chr>  \n1     1 Fungi¬† Dikaria  Ascomyc‚Ä¶ Pezizo‚Ä¶ Eurot‚Ä¶ Eurotiom‚Ä¶ Euro‚Ä¶ -        Asperg‚Ä¶\n2     4 Fungi¬† Dikaria  Ascomyc‚Ä¶ Pezizo‚Ä¶ Sorda‚Ä¶ ¬†Hypocre‚Ä¶ Hypo‚Ä¶ -        Nectri‚Ä¶\n3     5 Fungi¬† Dikaria  Basidio‚Ä¶ Agaric‚Ä¶ ¬†Agar‚Ä¶ -         Poly‚Ä¶ -        Polypo‚Ä¶\n4    13 Fungi¬† Dikaria  Ascomyc‚Ä¶ Pezizo‚Ä¶ Sorda‚Ä¶ Hypocreo‚Ä¶ Hypo‚Ä¶ -        Bionec‚Ä¶\n5    17 Fungi¬† Dikaria  Mucorom‚Ä¶ Mucoro‚Ä¶ Umbel‚Ä¶ -         Umbe‚Ä¶ -        Umbelo‚Ä¶\n6    18 Fungi¬† Dikaria  Basidio‚Ä¶ Agaric‚Ä¶ Agari‚Ä¶ -         Cort‚Ä¶ -        Punctu‚Ä¶\n# ‚Ñπ 1 more variable: genero <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\ncolnames(dados_tax)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"id\"        \"reino\"     \"subreino\"  \"filo\"      \"subfilo\"   \"classe\"   \n [7] \"subclasse\" \"ordem\"     \"subordem\"  \"familia\"   \"genero\"   \n```\n\n\n:::\n\n```{.r .cell-code}\n# 3. Calcular a frequ√™ncia dos filos\nfreq_ordem <- as.data.frame(table(dados_tax$ordem))\ncolnames(freq_ordem) <- c(\"ordem\", \"frequencia\")\n\n# 4. Calcular a porcentagem\nfreq_ordem$porcentagem <- round(100 * freq_ordem$frequencia / sum(freq_ordem$frequencia), 1)\n\n# 5. Criar r√≥tulo para a legenda\nfreq_ordem$label <- paste0(freq_ordem$ordem, \" (\", freq_ordem$porcentagem, \"%)\")\n\n# 6. Gerar o gr√°fico de pizza\nggplot(freq_ordem, aes(x = \"\", y = frequencia, fill = label)) +\n  geom_bar(stat = \"identity\", width = 1) +\n  coord_polar(\"y\", start = 0) +\n  labs(caption = \"Fonte: Betim, 2025.\") +\n  theme_void() +\n  theme(legend.position = \"right\") +\n  guides(fill = guide_legend(title = \"Ordem\"))\n```\n\n::: {.cell-output-display}\n![](melhoresprodutores_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "melhoresprodutores_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}